{% extends "base.html" %}
{% block title %}User Details{% endblock %}

{% block content %}

<section class="pb-24">

<div class="max-w-3xl mx-auto px-6">

    <div class="bg-white/70 backdrop-blur-lg border rounded-2xl p-8">

        <h1 class="text-2xl font-semibold mb-6">
            {{ user.full_name }}
        </h1>

        <div class="space-y-3 text-sm text-gray-700">

            <p><strong>Username:</strong> {{ user.username }}</p>
            <p><strong>Email:</strong> {{ user.email }}</p>
            <p><strong>Phone:</strong> {{ user.phone_number }}</p>
            <p><strong>Role:</strong> {{ user.role }}</p>
            <p><strong>Joined:</strong> {{ user.created_at }}</p>

        </div>

        <div class="mt-8 flex gap-3">
            {% if user.role == "participant" %}
                <button onclick="changeRole('volunteer')"
                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg">
                    Make Volunteer
                </button>
            {% elif user.role == "volunteer" %}
                <button onclick="changeRole('participant')"
                    class="px-4 py-2 bg-gray-600 text-white rounded-lg">
                    Revoke Volunteer
                </button>
                <button onclick="changeRole('organizer')"
                    class="px-4 py-2 bg-yellow-600 text-white rounded-lg">
                    Make Organizer
                </button>
            {% else %}
                <button onclick="changeRole('volunteer')"
                    class="px-4 py-2 bg-green-600 text-white rounded-lg">
                    Revoke Organizer
                </button>
                <button onclick="changeRole('participant')"
                    class="px-4 py-2 bg-red-600 text-white rounded-lg">
                    Make Participant
                </button>
            {% endif %}

            <button onclick="deactivateUser()"
                class="px-4 py-2 border border-red-300 text-red-600 rounded-lg">
                Deactivate
            </button>

        </div>

    </div>

</div>

</section>

<script>
const userUUID = "{{ user.uuid }}";

function sendAction(data){
    fetch(`/user/view/${userUUID}/`,{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "X-CSRFToken":document.cookie.split('csrftoken=')[1]
        },
        body:JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(d=>alert(d.message));
}

function changeRole(role){
    sendAction({action:"change_role", role});
}

function deactivateUser(){
    sendAction({action:"deactivate"});
}
</script>

{% endblock %}